<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Media Collection Dashboard</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg,#667eea 0%,#764ba2 100%);
    color: #333; padding: 20px;
  }
  .header { text-align:center; margin-bottom:24px; color:#fff; text-shadow:0 2px 4px rgba(0,0,0,.3); }
  .header h1 { font-size:2rem; margin-bottom:6px; }
  .header p { font-size:1rem; opacity:.9; }

  .stats { display:flex; justify-content:center; gap:16px; margin-bottom:20px; flex-wrap:wrap; }
  .stat-card {
    background: rgba(255,255,255,.92);
    padding:12px 18px; border-radius:12px; text-align:center;
    box-shadow:0 8px 24px rgba(0,0,0,.08); border:1px solid rgba(255,255,255,.14);
  }
  .stat-number { font-size:1.4rem; font-weight:700; color:#667eea; }
  .stat-label { font-size:.85rem; color:#666; }

  .filters { display:flex; justify-content:center; gap:12px; margin-bottom:18px; flex-wrap:wrap; }
  .search-container { display:flex; gap:8px; align-items:center; }
  .search-input {
    padding:10px 12px; border-radius:20px; border:none; min-width:200px;
    box-shadow:0 4px 12px rgba(0,0,0,.08); font-size:1rem;
  }
  .sort-select, .filter-btn {
    padding:10px 14px; border-radius:20px; border:none; cursor:pointer; font-weight:600;
    box-shadow:0 4px 12px rgba(0,0,0,.08);
  }
  .filter-btn.active { background:#667eea; color:#fff; }

  .gallery {
    display:grid; grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
    gap:20px; max-width:1400px; margin:0 auto;
  }
  .movie-card {
    background:rgba(255,255,255,.96); border-radius:14px; overflow:hidden;
    box-shadow:0 12px 28px rgba(0,0,0,.08); display:flex; flex-direction:column;
    transition:transform .22s ease, box-shadow .22s ease;
  }
  .movie-card:hover { transform:translateY(-8px); box-shadow:0 22px 46px rgba(0,0,0,.12); }

  .poster-container { position:relative; width:100%; height:360px; overflow:hidden; background:#efefef; display:flex; align-items:center; justify-content:center; }
  .poster { width:100%; height:100%; object-fit:cover; display:block; }
  .no-poster { padding:12px; color:#999; text-align:center; }

  .movie-info { padding:14px; display:flex; flex-direction:column; gap:8px; flex-grow:1; }
  .movie-title { font-size:1.05rem; font-weight:700; color:#333; line-height:1.2; }
  .movie-year { color:#667eea; font-weight:600; font-size:.95rem; }
  .movie-type { display:inline-block; background:linear-gradient(45deg,#667eea,#764ba2); color:#fff; padding:4px 10px; border-radius:12px; font-size:.78rem; font-weight:600; margin-top:auto; }
  .imdb-link { display:inline-block; background:#f5c518; color:#000; padding:6px 12px; border-radius:6px; text-decoration:none; font-weight:600; font-size:.88rem; }

  .status-badge { position:absolute; top:10px; right:10px; padding:6px 10px; border-radius:12px; font-weight:700; font-size:.75rem; color:#fff; }
  .status-found { background:rgba(46,204,13,.92); }
  .status-not-found { background:rgba(231,76,60,.92); }

  .hidden { display:none !important; }
  .loading { text-align:center; color:#fff; font-size:1rem; margin:18px 0; }
  .spinner { border:4px solid rgba(255,255,255,.25); border-top:4px solid #fff; border-radius:50%; width:36px; height:36px; animation:spin 1s linear infinite; margin:0 auto 10px; }
  @keyframes spin { 0%{transform:rotate(0)} 100%{transform:rotate(360deg)} }

  @media (max-width:768px){ .poster-container{height:300px} .movie-card{min-height:420px} }
  @media (max-width:480px){ .gallery{grid-template-columns:1fr} .poster-container{height:260px} }
</style>
</head>
<body>
  <div class="header">
    <h1>Media Collection Dashboard</h1>
    <p>Your movie & TV show library</p>
  </div>

  <div class="stats">
    <div class="stat-card"><div class="stat-number" id="total-count">0</div><div class="stat-label">Total Items</div></div>
    <div class="stat-card"><div class="stat-number" id="movie-count">0</div><div class="stat-label">Movies</div></div>
    <div class="stat-card"><div class="stat-number" id="series-count">0</div><div class="stat-label">TV Series</div></div>
    <div class="stat-card"><div class="stat-number" id="found-count">0</div><div class="stat-label">Found</div></div>
  </div>

  <div class="filters">
    <div class="search-container">
      <input id="search-input" class="search-input" placeholder="Search by title..." />
      <select id="sort-select" class="sort-select">
        <option value="none">Sort by Title</option>
        <option value="asc">A–Z</option>
        <option value="desc">Z–A</option>
      </select>
    </div>
    <button class="filter-btn active" data-filter="all">All</button>
    <button class="filter-btn" data-filter="movie">Movies</button>
    <button class="filter-btn" data-filter="series">Series</button>
    <button class="filter-btn" data-filter="found">Found</button>
    <button class="filter-btn" data-filter="not-found">Not Found</button>
  </div>

  <div id="loading" class="loading">
    <div class="spinner"></div>
    Loading data...
  </div>

  <div id="movie-gallery" class="gallery" aria-live="polite"></div>

<script>
  (function () {
    const DATA_URL = 'https://raw.githubusercontent.com/karthiknayakb/media_dashboard/refs/heads/master/data.json';
    let moviesData = [];
    let currentFilter = 'all';
    const gallery = document.getElementById('movie-gallery');
    const loadingEl = document.getElementById('loading');
    const searchInput = document.getElementById('search-input');
    const sortSelect = document.getElementById('sort-select');
    const filtersEl = document.querySelector('.filters');

    function hideLoading() { loadingEl.style.display = 'none'; }
    function showLoading() { loadingEl.style.display = 'block'; }

    function createMovieCard(movie) {
      const posterUrl = movie['Poster URL'] || '';
      const hasPoster = posterUrl && posterUrl !== 'N/A';
      const posterHtml = hasPoster
        ? `<img loading="lazy" src="${escapeHtml(posterUrl)}" alt="${escapeHtml(movie['Original Title'] || 'Poster')}" class="poster" onerror="this.style.display='none'; this.parentNode.querySelector('.no-poster').style.display='flex'">`
        : `<div class="no-poster">No Poster Available</div>`;

      const imdbLink = movie['IMDb URL'] ? `<a class="imdb-link" href="${escapeHtml(movie['IMDb URL'])}" target="_blank" rel="noopener noreferrer">View on IMDb</a>` : '';
      const statusClass = (movie['Status'] && movie['Status'].toString().toLowerCase() === 'found') ? 'status-found' : 'status-not-found';
      const statusText = (movie['Status'] && movie['Status'].toString().toLowerCase() === 'found') ? 'FOUND' : 'NOT FOUND';
      const typeBadge = (movie['Type'] && movie['Type'].toLowerCase() === 'movie') ? 'Movie' : (movie['Type'] && movie['Type'].toLowerCase() === 'series') ? 'TV Series' : 'Unknown';

      return `
        <div class="movie-card" data-type="${escapeAttr(movie['Type'])}" data-status="${escapeAttr(movie['Status'])}">
          <div class="poster-container">
            ${posterHtml}
            <div class="no-poster" style="display:${hasPoster ? 'none' : 'flex'}">No Poster Available</div>
            <span class="status-badge ${statusClass}">${statusText}</span>
          </div>
          <div class="movie-info">
            <div class="movie-title">${escapeHtml(movie['Original Title'] || 'Untitled')}</div>
            <div class="movie-year">${escapeHtml(movie['Year'] || 'Year Unknown')}</div>
            <div style="display:flex; gap:8px; align-items:center;">
              <span class="movie-type">${escapeHtml(typeBadge)}</span>
              ${imdbLink}
            </div>
          </div>
        </div>`;
    }

    function escapeHtml(s) {
      if (!s && s !== 0) return '';
      return String(s).replace(/[&<>"']/g, (c) => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
    }
    function escapeAttr(s){ return escapeHtml(s); }

    function updateStats(list) {
      document.getElementById('total-count').textContent = String(list.length);
      document.getElementById('movie-count').textContent = String(list.filter(m => (m['Type']||'').toLowerCase() === 'movie').length);
      document.getElementById('series-count').textContent = String(list.filter(m => (m['Type']||'').toLowerCase() === 'series').length);
      document.getElementById('found-count').textContent = String(list.filter(m => (m['Status']||'').toLowerCase() === 'found').length);
    }

    function applyFiltersAndRender() {
      const searchTerm = (searchInput.value || '').trim().toLowerCase();
      const sortType = sortSelect.value;
      let filtered = moviesData.slice();

      switch (currentFilter) {
        case 'movie': filtered = filtered.filter(m => (m['Type']||'').toLowerCase() === 'movie'); break;
        case 'series': filtered = filtered.filter(m => (m['Type']||'').toLowerCase() === 'series'); break;
        case 'found': filtered = filtered.filter(m => (m['Status']||'').toLowerCase() === 'found'); break;
        case 'not-found': filtered = filtered.filter(m => (m['Status']||'').toLowerCase() !== 'found'); break;
        case 'all':
        default:
          break;
      }

      if (searchTerm) {
        filtered = filtered.filter(m => (m['Original Title']||'').toLowerCase().includes(searchTerm));
      }

      if (sortType === 'asc') {
        filtered.sort((a,b) => (a['Original Title']||'').localeCompare(b['Original Title']||''));
      } else if (sortType === 'desc') {
        filtered.sort((a,b) => (b['Original Title']||'').localeCompare(a['Original Title']||''));
      }

      renderList(filtered);
      updateStats(filtered);
    }

    function renderList(list) {
      if (!list.length) {
        gallery.innerHTML = `<div style="color:#fff;text-align:center;padding:28px">No items to display</div>`;
        return;
      }
      gallery.innerHTML = list.map(createMovieCard).join('');
    }

    function attachUiHandlers() {
      filtersEl.addEventListener('click', (ev) => {
        const btn = ev.target.closest('.filter-btn');
        if (!btn) return;
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentFilter = btn.dataset.filter || 'all';
        applyFiltersAndRender();
      });

      searchInput.addEventListener('input', () => { applyFiltersAndRender(); });
      sortSelect.addEventListener('change', () => { applyFiltersAndRender(); });
    }

    async function loadData() {
      showLoading();
      try {
        const res = await fetch(DATA_URL);
        if (!res.ok) throw new Error(`Fetch failed: ${res.status}`);
        const data = await res.json();
        if (!Array.isArray(data)) moviesData = Array.isArray(data.items) ? data.items : [];
        else moviesData = data;
      } catch (err) {
        console.error('Failed to load data', err);
        moviesData = []; // keep empty
      } finally {
        hideLoading();
        attachUiHandlers();
        applyFiltersAndRender();
      }
    }

    // Start
    loadData();
  })();
</script>
</body>
</html>
